\documentclass[a4paper]{article}
\usepackage[pdftex]{geometry}
\usepackage[utf8]{inputenc}
\usepackage{listings}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{multicol}
\usepackage{courier}
\usepackage{fancyhdr}
\usepackage{enumitem}
\usepackage{hyperref}
\usepackage{lastpage}

\lstset{columns=fullflexible}
\lstset{basicstyle=\scriptsize\ttfamily}
\lstset{showspaces=false}
\lstset{showstringspaces=false}
%
\geometry{portrait}
\setlength{\topmargin}{-0.5in}
\setlength{\oddsidemargin}{-0.5in}
%\setlength{\evensidemargin}{-in}
\setlength{\columnsep}{1in}
\setlength{\columnseprule}{0.2pt}
\textwidth 185mm
\textheight 250mm

\pagestyle{fancy}
\lhead{NRU HSE NN 1 (Doroshenko, Kuznetsov, Zarkov)}
\chead{}
\rhead{\thepage\ of \pageref{LastPage}}
\lfoot{}
\cfoot{}
\rfoot{}

\usepackage{cmap}					% поиск в PDF
\usepackage{mathtext} 				% русские буквы в формулах
\usepackage[T2A]{fontenc}			% кодировка
\usepackage[utf8]{inputenc}			% кодировка исходного текста
\usepackage[english,russian]{babel}	% локализация и переносы

%%% Дополнительная работа с математикой
\usepackage{amsmath,amsfonts,amssymb,amsthm,mathtools} % AMS
\usepackage{icomma} % "Умная" запятая: $0,2$ --- число, $0, 2$ --- перечисление

%% Номера формул
\mathtoolsset{showonlyrefs=true} % Показывать номера только у тех формул, на которые есть \eqref{} в тексте.

%% Шрифты
\usepackage{euscript}	 % Шрифт Евклид
\usepackage{mathrsfs} % Красивый матшрифт

\newcommand{\includecpp}[2]{
	\subsection{#1}\
	\lstinputlisting[language=c++, breaklines=true]{#2}
}

\newcommand{\floor}[1]{\lfloor #1 \rfloor}

\begin{document}
	\thispagestyle{fancy}
	\pagenumbering{Roman}
	
	\begin{center}
		\Huge\textsc{ICPC Team Reference Document}
		
		\huge NRU HSE NN 1
		
		\vspace{0.50cm}
	\end{center}
	
	\begin{multicols*}{2}
		\tableofcontents
		
		\pagenumbering{arabic}
		\setcounter{page}{1}
		%\input{contents.tex}
	\end{multicols*}
	\enlargethispage*{\baselineskip}
	\pagebreak
	
	% == CONTENTS == %
	
	\pagenumbering{arabic}
	\setcounter{page}{2}
	%
	\begin{multicols*}{2}
		\section{Шаблон}
		\lstinputlisting[language=C++]{fcpp/template.cpp}
		
		\section{Алгоритмы на строки}
		\subsection{Префикс-функция}
		\lstinputlisting[language=C++]{fcpp/pfunc.cpp}
		\subsection{Z-функция}
		\lstinputlisting[language=C++]{fcpp/zfunc.cpp}
		\subsection{Хеширование}
		\lstinputlisting[language=C++]{fcpp/hash.cpp}
		\subsection{Нахождение всех подпалиндромов}
		Для случая подпалиндромов нечётной длины
		\lstinputlisting[language=C++]{fcpp/palindromes_count1.cpp}
		Для подпалиндромов чётной длины
		\lstinputlisting[language=C++]{fcpp/palindromes_count2.cpp}
		\subsection{Суффиксный массив}
		Построение $O (n log n) $
		\lstinputlisting[language=C++]{fcpp/sm.cpp}
		Наибольший общий префикс двух подстрок
		\lstinputlisting[language=C++]{fcpp/lcp.cpp}
		
		
		\section{Алгоритмы на графах}
		\subsection{Алгоритм Дейкстры $O(n^2)$}
		was - брали вершину или нет 
		v - список смежности 
		d - массив расстояний для точки x
		\lstinputlisting[language=C++]{fcpp/dijkstra-n2.cpp}
		\subsection{Алгоритм Дейкстры $O(log(n) \cdot m)$}
		d - массив расстояний для точки x
		\lstinputlisting[language=C++]{fcpp/dijkstra-nm.cpp}		
		\subsection{Поток}
		\lstinputlisting[language=C++]{fcpp/potol.cpp}
		\subsection{Поиск компонент сильной связности, построение конденсации графа $O(N+M)$}
		Дан ориентированный граф G, множество вершин которого V и множество рёбер — E. Петли и кратные рёбра допускаются. Обозначим через n количество вершин графа, через m — количество рёбер.
		
		Компонентой сильной связности (strongly connected component) называется такое (максимальное по включению) подмножество вершин C, что любые две вершины этого подмножества достижимы друг из друга, т.е. для $\forall u,v \in C:$
		
		$u \mapsto v, v \mapsto u $
		\lstinputlisting[language=C++]{fcpp/strong_connected_components.cpp}
		\subsection{Поиск мостов $O(N+M)$}
		Пусть дан неориентированный граф. Мостом называется такое ребро, удаление которого делает граф несвязным (или, точнее, увеличивает число компонент связности). Требуется найти все мосты в заданном графе.		
		\lstinputlisting[language=C++]{fcpp/bridge_searching.cpp}
		\subsection{Поиск точек сочленения}
		Пусть дан связный неориентированный граф. Точкой сочленения (или точкой артикуляции, англ. "cut vertex" или "articulation point") называется такая вершина, удаление которой делает граф несвязным.
		\lstinputlisting[language=C++]{fcpp/cutpoints.cpp}
		\subsection{Нахождение отрицательного цикла в графе}
		\lstinputlisting[language=C++]{fcpp/negative_cycle.cpp}
		\subsection{Топологическая сортировка}
		\lstinputlisting[language=C++]{fcpp/topological_sort.cpp}
		\subsection{Алгоритм Куна нахождения наибольшего паросочетания в двудольном графе}
		\lstinputlisting[language=C++]{fcpp/kuhn_matching.cpp}
		\subsection{Венгерский алгоритм решения задачи о назначениях}
		\lstinputlisting[language=C++]{fcpp/assignment_hungary.cpp}
		
		\section{Простые алгоритмы}		
		\subsection{Решето Эратосфена $O(n)$}
		pr - все простые числа до n \\
		lp - минимальный простой делитель числа i
		\lstinputlisting[language=C++]{fcpp/resheto-n.cpp} 
		

		\subsection{Решето Эратосфена \\ $O(n \cdot log(log(n)))$}
		d[i] == 0 если число i простое
		\lstinputlisting[language=C++]{fcpp/resheto-nloglogn.cpp}
		\subsection{Умножение чисел по модулю}
		\lstinputlisting[language=C++]{fcpp/mulmod.cpp}
		\subsection{Функция Эйлера}
		Количество таких чисел в отрезке [1; n], наибольший общий делитель которых с n равен единице.
		
		Если p — простое число, то $\phi$ (p)=p-1.
		(Это очевидно, т.к. любое число, кроме самого p, взаимно просто с ним.)
		
		Если p — простое, a — натуральное число, то $\phi (p^a)=p^a-p^{a-1}$.
		(Поскольку с числом $p^a$ не взаимно просты только числа вида $pk (k \in \mathcal{N})$, которых $p^a / p = p^{a-1}$ штук.)
		
		Если a и b взаимно простые, то $\phi(ab) = \phi(a) \phi(b) $
		
		Самое известное и важное свойство функции Эйлера выражается в теореме Эйлера:
		
		$a^{\phi(m)} \equiv 1 \pmod m$, 
		
		где $\it a$ и $\it m$ взаимно просты.
		В частном случае, когда $\it m$ простое, теорема Эйлера превращается в так называемую малую теорему Ферма:
		
		$a^{m-1} \equiv 1  \pmod m $
		\lstinputlisting[language=C++]{fcpp/euler_function.cpp}
		\subsection{Алгоритм Евклида}
		\lstinputlisting[language=C++]{fcpp/euclid_algorithm.cpp}
		\subsection{Расширенный алгоритм Евклида}
		$a \cdot x + b \cdot y = {\rm gcd} (a, b).$
		\lstinputlisting[language=C++]{fcpp/extended_euclid_algorithm.cpp}
		\subsection{Обратный элемент в кольце по модулю}
		Обратным к числу a по модулю m называется такое число b, что:
		
		$a \cdot b \equiv 1 \pmod m$
		\lstinputlisting[language=C++]{fcpp/reverse_element1.cpp}
		\subsection{Нахождение всех простых по заданному модулю за линейное время}
		\lstinputlisting[language=C++]{fcpp/reverse_element2.cpp}
		\subsection{Дискретное логарифмирование}
		Задача дискретного логарифмирования заключается в том, чтобы по данным целым a, b, m решить уравнение:
		
		$a^x = b \pmod m$, 
		
		где a и m — взаимно просты 
		\lstinputlisting[language=C++]{fcpp/discrete_log.cpp}
		\subsection{Китайская теорема об остатках}
		\lstinputlisting[language=C++]{fcpp/chinese_theorem.cpp}
		
		\section{Структуры данных}
		\subsection{Дерево отрезков}
		\lstinputlisting[language=C++]{fcpp/subtree.cpp}
		 Прибавление на отрезке
		 \lstinputlisting[language=C++]{fcpp/subtree-add.cpp}
		 Присвоение на отрезке
		 \lstinputlisting[language=C++]{fcpp/subtree-push.cpp}
		 \subsection{Дерево Фенвика для суммы для одномерного случая}
		 \lstinputlisting[language=C++]{fcpp/fenwick_tree1.cpp}		 
		 \subsection{Дерево Фенвика для суммы для двумерного случая}
		 \lstinputlisting[language=C++]{fcpp/fenwick_tree2.cpp}
		 \subsection{Система непересекающихся множеств}
		 \lstinputlisting[language=C++]{fcpp/dsu.cpp}
		 \subsubsection{Поддержка расстояний до лидера}
		 \lstinputlisting[language=C++]{fcpp/dsu1.cpp}
		 
		 \section{Геометрия}
		 \subsection{Полярный угол}
		 \lstinputlisting[language=C++]{fcpp/polyar.cpp}
		 \subsection{Скалярное произведение, угол между векторами}
		 
		 $\vec a \cdot \vec b = |\vec a| \cdot |\vec b| \cdot cos \varphi$
		 
		 $\vec a \cdot \vec b = x_1 \cdot x_2 + y_1 \cdot y_2$
		 
		 $|\vec a| = \sqrt{x^2 + y^2}$
		 \lstinputlisting[language=C++]{fcpp/skalar.cpp}
		 \subsection{Площадь многоугольника}
		 \lstinputlisting[language=C++]{fcpp/ploshad.cpp}		 
		 \subsection{Площадь треугольника}
		 \lstinputlisting[language=C++]{fcpp/ploshad-tr.cpp}
		 \subsection{Расстояние от точки до прямой}
		 a b c коэффициенты нормального уравнения прямой
		 \lstinputlisting[language=C++]{fcpp/rast-t-p.cpp}
		 \subsection{Нормальное уравнение по двум точкам}
		 \lstinputlisting[language=C++]{fcpp/norm-yr.cpp}	
		 \subsection{Построение выпуклой оболочки обходом Грэхэма $O (N log N)$}
		 \lstinputlisting[language=C++]{fcpp/convex_hull_graham.cpp}
		 \subsection{Точка пересечения прямых по коэффициентам}
		 \lstinputlisting[language=C++]{fcpp/tpp.cpp}
		 
		 \section{Числа Фибоначчи}		 
		 \subsection{Свойства чисел Фибоначчи}
		 
		 Соотношение Кассини:
		 
		 $F_{n+1} F_{n-1} - F_n^2 = (-1)^n.$
		 
		 Правило "сложения":
		 
		 $F_{n+k} = F_k F_{n+1} + F_{k-1} F_n.$ 
		 
		 Из предыдущего равенства при k = n вытекает:
		 
		 $F_{2n} = F_n (F_{n+1} + F_{n-1}).$ 
		 
		 Из предыдущего равенста по индукции можно получить, что
		 
		 $F_{nk}$ всегда кратно $F_n$.
		 
		 Верно и обратное к предыдущему утверждение:
		 
		 если $F_m$ кратно $F_n$, то m кратно n.
		 
		 НОД-равенство:
		 
		 ${\rm gcd} (F_m, F_n) = F_{{\rm gcd} (m, n)}$. 
		 
		 Теорема Цекендорфа утверждает, что любое натуральное число n можно представить единственным образом в виде суммы чисел Фибоначчи:
		 
		 $N = F_{k_1} + F_{k_2} + \ldots + F_{k_r}$
		 
		 где $k_1 \ge k_2+2, k_2 \ge k_3+2, \ldots, k_r \ge 2$ (т.е. в записи нельзя использовать два соседних числа Фибоначчи).
		 
		 Нетрудно получить и правило прибавления единицы к числу в фибоначчиевой системе счисления: если младшая цифра равна 0, то её заменяем на 1, а если равна 1 (т.е. в конце стоит 01), то 01 заменяем на 10. Затем "исправляем" запись, последовательно исправляя везде 011 на 100. В результате за линейное время будет получена запись нового числа.
		 
		 Перевод числа в фибоначчиеву систему счисления осуществляется простым "жадным" алгоритмом: просто перебираем числа Фибоначчи от больших к меньшим и, если некоторое $F_k \le n$, то $F_k$ входит в запись числа n, и мы отнимаем $F_k$ от n и продолжаем поиск.
		 
		  \section{Теория чисел}
		  \subsection{Постулат Бертрана}
		  Постулат Бертрана гласит, что для любого n > 1 найдется простое число p в интервале n < p < 2n
		  \subsection{Треугольное число}
		  Треугольное число — один из типов фигурных чисел, определяемый как число точек, которые могут быть расставлены в форме правильного треугольника (см. рисунок). Очевидно, с чисто арифметической точки зрения, n-е треугольное число — это сумма n первых натуральных чисел.
		  
		  $T_n = \frac{1/2}n(n+1)$
		  \subsection{Совершенные числа}
		  Натуральное число, равное сумме всех своих собственных делителей\\
		  6,\\
		  28,\\
		  496,\\
		  8128,\\
		  33 550 336,\\
		  8 589 869 056,\\
		  137 438 691 328,\\
		  2 305 843 008 139 952 128,\\
		  2 658 455 991 569 831 744 654 692 615 953 842 176,\\
		  191 561 942 608 236 107 294 793 378 084 303 638 130 997 321 548 169 216
		  \subsection{Числа Каталана}
		  n-е число Каталана ${\displaystyle C_{n}}C_{n}$ можно определить несколькими эквивалентными способами, такими как:
		  
		  Количество разбиений выпуклого (n+2)-угольника на треугольники непересекающимися диагоналями.
		  
		  
		  Количество способов соединения 2n точек на окружности n непересекающимися хордами.
		  
		  
		  Количество правильных скобочных последовательностей длины 2n, то есть таких последовательностей из n левых и n правых скобок, в которых количество открывающих скобок равно количеству закрывающих, и в любом её префиксе открывающих скобок не меньше, чем закрывающих.
		  
		
		  Например, для n = 3 существует 5 таких последовательностей:
		  ((())), ()(()), ()()(), (())(), (()())
		  то есть ${\displaystyle C_{3}=5}C_{3}=5.$
		  
		  Количество кортежей 
		  
		  ${\displaystyle (x_{1},x_{2},\ldots ,x_{n})}{\displaystyle (x_{1},x_{2},\ldots ,x_{n})}$ из n натуральных чисел, таких, что ${\displaystyle x_{1}=1}x_1=1$ и ${\displaystyle x_{i}\leqslant x_{i-1}+1}{\displaystyle x_{i}\leqslant x_{i-1}+1}$ при ${\displaystyle 2\leqslant i\leqslant n}2 \leqslant i \leqslant n$.
		  
		  Количество неизоморфных упорядоченных бинарных деревьев с корнем и n + 1 листьями.
		  
		  Количество всевозможных способов линеаризации декартова произведения 2 линейных упорядоченных множеств: из 2 и из n элементов.
		  \subsection{Число и сумма делителей}
		  Число делителей
		  
		  $r(\alpha) = (\alpha_1 + 1)(\alpha_2 +1)...(\alpha_k+1)$
		  
		  Сумма делителей
		  
		  $S(\alpha) = \frac{p^{{\alpha_1}+1}_{1} - 1}{p_1 - 1} \frac{p^{{\alpha_2}+1}_{2} - 1}{p_2 - 1} ... \frac{p^{{\alpha_k}+1}_{k} - 1}{p_k - 1}$
		  \subsection{Биномиальные коэффициенты}
		  \lstinputlisting[language=C++]{fcpp/c.cpp}
		  
		  \section{Динамическое программирование}
		  \subsection{Рюкзак}
		  Задача из семейства, в которой стоимость предмета совпадает с его весом.
		  \lstinputlisting[language=C++]{fcpp/chest1.cpp}
		  \subsection{Наибольшая возрастающая подпоследовательность}
		  \lstinputlisting[language=C++]{fcpp/ncp.cpp}
		  \section{Геометрия 2}
		  \lstinputlisting[language=C++]{fcpp/geo.cpp}
		  \subsection{Формулы}
		  Площадь треугольника через две стороны и
		  угол между ними
$S = \frac{1}{2}ab\cdot siny$
		  
		 Площадь треугольника через радиус
		 описанной окружности $ S = \frac{abc}{4R} $
		 
		 Формула медианы 
		 $ m = \frac{1}{2} \sqrt{2(b^2 + c^ 2) - a^2}$
		 
		 Формула высоты
		 $ h = \frac{2}{a} \sqrt{p(p-a)(p-b)(p-c)} $
		 
		 Теорема косинусов
		 $ a^2 = b^2 + c^2 – 2bc\cdot cos a$
		 
		 Радиус окружности, вписанной в правильный
		 треугольник
		 $r = \frac{a\sqrt{3}}{3} $
		 
		 Радиус окружности, вписанной в
		 прямоугольный треугольник
		 $r = \frac{a+b-c}{2} $
		 
		 Радиус окружности, описанной около
		 прямоугольного треугольника
		 $R = \frac{c}{2} $
		 
		 Площадь правильного треугольника
		 $ S = \frac{a^2 \sqrt{3}}{4} $
		 
		 Объем шарового сегмента
		 $ V = \pi h^2(R-\frac{1}{3}h) $
		 
		 Площадь сегмента круга
		 $ S = \frac{1}{2}R^2(\frac{\pi\alpha}{180^{\circ}} - sin a) $
		 
		 \subsection{Тригонометрия}
		 $\operatorname {sin}^{2}\alpha +\operatorname {cos}^{2}\alpha =1$ \\
		 $\operatorname {tg}^{2}\alpha +1={\frac {1}{\cos ^{2}\alpha }}=\operatorname {sec}^{2}\alpha $ \\
		 $\operatorname {ctg}^{2}\alpha +1={\frac {1}{\sin ^{2}\alpha }}=\operatorname {cosec}^{2}\alpha $ \\
		 ${\displaystyle \operatorname {tg} \alpha \cdot \operatorname {ctg} \alpha =1}$ \\
		 $\sin \left(\alpha \pm \beta \right)=\sin \alpha \cos \beta \pm \cos \alpha \sin \beta $\\
		 $\cos \left(\alpha \pm \beta \right)=\cos \alpha \cos \beta \mp \sin \alpha \sin \beta $
		 $\operatorname {tg}\left(\alpha \pm \beta \right)={\frac {\operatorname {tg}\alpha \pm \operatorname {tg}\beta }{1\mp \operatorname {tg}\alpha \operatorname {tg}\beta }}$ \\
		 $\sin \alpha \sin \beta ={\frac {\cos(\alpha -\beta )-\cos(\alpha +\beta )}{2}}$\\
		 $\sin \alpha \cos \beta ={\frac {\sin(\alpha -\beta )+\sin(\alpha +\beta )}{2}}$\\
		 $\cos \alpha \cos \beta ={\frac {\cos(\alpha -\beta )+\cos(\alpha +\beta )}{2}}$\\
		 $\sin \alpha \pm \sin \beta =2\sin {\frac {\alpha \pm \beta }{2}}\cos {\frac {\alpha \mp \beta }{2}}$ \\
		 $\cos \alpha +\cos \beta =2\cos {\frac {\alpha +\beta }{2}}\cos {\frac {\alpha -\beta }{2}}$ \\
		 $\cos \alpha -\cos \beta =-2\sin {\frac {\alpha +\beta }{2}}\sin {\frac {\alpha -\beta }{2}}$\\
		 $\operatorname {tg}\alpha \pm \operatorname {tg}\beta ={\frac {\sin(\alpha \pm \beta )}{\cos \alpha \cos \beta }}$ \\
	\end{multicols*}
\end{document}
